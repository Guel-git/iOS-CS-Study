## Chap10. 프로세스와 스레드

### 10-1 프로세스 개요
실행 중인 프로그램

>**프로세스 직접 확인하기**

사용자가 보는 앞에서 실행되는 포그라운드 프로세스, 보지 못하는 뒤편에서 실행되는 백그라운드 프로세스 (데몬/서비스)

<br>

>**프로세스 제어 블록 (PCB)**

- 프로세스의 실행 순서를 관리하고, 프로세스에 자원을 배분하는 역할
- 메모리의 커널 영역에 생성
- 프로세스 생성시 만들어지며, 실행 후 폐기됨

- PCB에 담기는 정보 <br>
  - 프로세스 ID: 프로세스를 식별하기 위한 고유 번호
  - 레지스터 값: 자신의 실행 차례가 되면 이전에 사용했던 레지스터의 중간값 복원
  - 프로세스 상태: 기다리는지 사용하고 있는지
  - CPU 스케줄링 정보: 언제 어떤 순서로 할당 받을지
  - 메모리 관리 정보: 메모리 어디에 저장되어 있는지

<br>

>**문맥 교환**

- 하나의 프로세스 수행을 재개하기 위해 기억해야 하는 정보, **문맥**
- 기존 프로세스의 문맥을 PCB에 백업하고 새로운 프로세스를 실행하기 위해 문맥을 PCB로부터 복구하여 새로운 프로세스를 실행하는 것, **문맥 교환**

<br>

>**프로세스의 메모리 영역**

  <img width="267" alt="스크린샷 2023-07-17 오전 9 29 38" src="https://github.com/Guel-git/iOS-CS-Study/assets/81340603/ba87bf1a-4b3d-4d75-8e62-e21c034236d4">

- 코드 영역 (텍스트 영역): 실행할 수 있는 기계어로 이루어진 명령어, 읽기 전용 공간
- 데이터 영역: 프로그램이 실행되는 동안 유지할 데이터 저장 (ex. 전역 변수)
- 힙 영역: 프로그래머가 직접 할당할 수 있는 저장 공간, 메모리 공간 반환 필요 > 안할 경우 메모리 누수 발생
- 스택 영역: 데이터를 일시적으로 저장하는 공간

<br>

### 10-2 프로세스 상태와 계층 구조

>**프로세스 상태**

- 생성 상태: 프로세스를 생성 중인 상태, 메모리에 적재되어 PCB를 할당 받은 상태
- 준비 상태: 자신의 차례를 기다리고 있는 상태
- 실행 상태: CPU를 할당받아 실행 중인 상태
- 대기 상태: 입출력 장치의 작업을 기다리는 상태
- 종료 상태: 프로세스가 종료된 상태

  <img width="387" alt="스크린샷 2023-07-17 오전 9 31 57" src="https://github.com/Guel-git/iOS-CS-Study/assets/81340603/d4b10622-7be6-4c59-bcbc-20b51832ad8c">

<br>

>**프로세스 계층 구조**

프로세스는 실행 도중 시스템 호출을 통해 다른 프로세스 생성 가능 > 생성한 프로세스를 부모 프로세스, 생성된 프로세스를 자식 프로세스라 함

둘의 PID는 다르며, 간혹 자식 프로세스는 부모 프로세스의 ID인 PPID가 기록되기도 함

이러한 구조를 트리로 나타낸 것이 **프로세스 계층 구조**

<br>

>**프로세스 생성 기법**

**복제와 옷 갈아입기**

1. fork: 부모 프로세스가 자신의 복사본을 자식 프로세스로 생성
2. exec: 자신의 메모리 공간을 다른 프로그램으로 교체

<br>

### 10-3 스레드
실행의 단위

>**프로세스와 스레드**

- 단일 스레드 프로세스: 실행의 흐름 단위가 하나
- 멀티 스레드 프로세스: 하나의 프로세스에서 여러 명령어(스레드)를 동시에 실행

  <img width="337" alt="스크린샷 2023-07-17 오전 10 13 39" src="https://github.com/Guel-git/iOS-CS-Study/assets/81340603/7e25ecd6-623e-4001-83a2-569020f89771">

- 프로세스의 스레드들은 실행에 필요한 최소한의 정보만을 유지한 채 프로세스 자원을 공유하며 실행

<br>

>**멀티프로세스와 멀티스레드**

- 멀티프로세스: 여러 프로세스를 동시에 실행하는 것
- 멀티스레드: 여러 스레드로 프로세스를 동시에 실행하는 것

- 프로세스를 여러 개 사용하는 것보다 하나의 프로세스 안에 멀티 스레드를 사용하는 게 메모리를 더 효율적으로 사용하는 방법
- 하나의 스레드에 문제가 생기면 프로세스 전체에 문제 발생 가능

- 프로세스 간 통신(IPC): 파일을 통한 프로세스 통신, 공유 메모리
